<!-- <ng4-loading-spinner [timeout]="90000" [loadingText]="'Please wait...'"> </ng4-loading-spinner> -->

<div class="container">
    <div class="row">
      <div class="col-12 text-center">
          <button class="btn btn-primary " (click)="showHideButton()">{{buttonName}} </button>
      </div>
    </div>
  </div>

<div class="card date card-block " *ngIf="showMainContent">
  <div class="card-body date-body">
    <form class="align-items-center d-flex justify-content-center" #form="ngForm" (submit)="onSubmit(fromDate, toDate)">
      <div class="form-group my-0">
        <label for="fromDate" for="toDate">From</label>

        <my-date-picker name="fromDate" [options]="myDatePickerOptions" [(ngModel)]="fromDate" required></my-date-picker>
        <!-- <span *ngIf="form.controls['fromDate'].errors?.required && form.controls['fromDate'].dirty">This field is required.</span> -->

      </div>
      <div class="col-sm-1">

      </div>
      <div class="form-group my-0" >
        <label for="toDate" for="toDate">To</label>
        <my-date-picker  name="toDate" [options]="myDatePickerOptions" [(ngModel)]="toDate" required></my-date-picker>
        <!-- <span *ngIf="form.controls['toDate'].errors?.required && form.controls['toDate'].dirty">This field is required.</span> -->
      </div>


        <!-- <label> </label> -->
        <div class="mt-4">
          <!-- <button mat-raised-button type="submit" class="btn btn-primary pull-right">Submit</button> -->
          <input [disabled]="!form.valid " class="btn btn-primary" type="submit" value="Submit" />
        </div>

    </form>
  </div>
</div>



<div class="card" *ngIf="!showMainContent">
  <div class="card-header c4">
    Total Compensation
  </div>
  <div class="card-body">
    <div>
        <div class="btn btn-primary btn-sm float-right" (click)="xlsxReport(dataSource1, 'Total_Compensation')">
            Export
          </div>
      <table class="table table-bordered">
        <tr class="table-secondary">
          <th  *ngFor="let col of displayedCol1">
            {{col}}
          </th>
        </tr>
        <tr class="table-warning"*ngFor="let col of dataSource1">
          <td>{{col.Total_Com_Frequency}}</td>
          <td>{{col.Total_Com_Amt}}</td>
          <td>{{col.Average_Com_Amt}}</td>
          <td>{{col.Max_Com_Amt}}</td>
          <td>{{col.Min_Com_Amt}}</td>
        </tr>
      </table>
    </div>
  </div>
</div>



<div class="card" *ngIf="showMainContent" >
  <div class="card-header c4">
    Compensation By

  </div>
  <tabset>
    <tab heading="Category" >
    <div class="table-wrapper" >
        <div class="btn btn-primary btn-sm float-right" (click)="xlsxReport(dataSource2, 'Compensation_by_category')">
            Export
          </div>
      <table class="table table-bordered">
        <tr>
          <th *ngFor="let col of displayedCol2">
            {{col}}
          </th>
        </tr>
        <tr *ngFor="let col of dataSource2 | paginate: { itemsPerPage: 7, currentPage: p2, id: 'second'}">
          <td>{{col.HWC_Category}}</td>
          <td>{{col.Comp_Frequency}}</td>
          <td>{{col.Comp_Amt}}</td>
          <td>{{col.Average_Comp_Amt}}</td>
          <td>{{col.Max_Comp_Amt}}</td>
          <td>{{col.Min_Comp_Amt}}</td>
        </tr>
      </table>
      <div class="float-right">
        <pagination-controls  (pageChange)="p2 = $event" id="second"></pagination-controls>
      </div>
    </div>
  </tab>
  <tab  heading="Park">
    <div class="table-wrapper" >
        <div class="btn btn-primary btn-sm float-right" (click)="xlsxReport(dataSource3, 'Compensation_by_park')">
            Export
          </div>
      <table class="table table-bordered">
        <tr>
          <th *ngFor="let col of displayedCol3">
            {{col}}
          </th>
        </tr>
        <tr *ngFor="let col of dataSource3">
          <td>{{col.PARK}}</td>
          <td>{{col.Comp_Frequency}}</td>
          <td>{{col.Comp_Amt}}</td>
          <td>{{col.Average_Comp_Amt}}</td>
          <td>{{col.Max_Comp_Amt}}</td>
          <td>{{col.Min_Comp_Amt}}</td>
        </tr>
      </table>
    </div>
  </tab>
  <tab  heading="Taluk">
    <div class="table-wrapper" >
        <div class="btn btn-primary btn-sm float-right" (click)="xlsxReport(dataSource4, 'Compensation_by_taluk')">
            Export
          </div>
      <table class="table table-bordered">
        <tr>
          <th *ngFor="let col of displayedCol4">
            {{col}}
          </th>
        </tr>
        <tr *ngFor="let col of dataSource4 | paginate: { itemsPerPage: 7, currentPage: p4, id: 'fourth'}">
          <td>{{col.TALUK}}</td>
          <td>{{col.Comp_Frequency}}</td>
          <td>{{col.Comp_Amt}}</td>
          <td>{{col.Average_Comp_Amt}}</td>
          <td>{{col.Max_Comp_Amt}}</td>
          <td>{{col.Min_Comp_Amt}}</td>
        </tr>
      </table>
      <div class="float-right">
      <pagination-controls (pageChange)="p4 = $event" id="fourth"></pagination-controls>
    </div>
    </div>
  </tab>
  <tab  heading="Village">
    <div class="table-wrapper" >
        <div class="btn btn-primary btn-sm float-right" (click)="xlsxReport(dataSource5, 'Compensation_by_village')">
            Export
          </div>
      <table class="table table-bordered">
        <tr>
          <th *ngFor="let col of displayedCol5">
            {{col}}
          </th>
        </tr>
        <tr *ngFor="let col of dataSource5 | paginate: { itemsPerPage: 7, currentPage: p5, id: 'fifth'}">
          <td>{{col.VILLAGE}}</td>
          <td>{{col.Comp_Frequency}}</td>
          <td>{{col.Comp_Amt}}</td>
          <td>{{col.Average_Comp_Amt}}</td>
          <td>{{col.Max_Comp_Amt}}</td>
          <td>{{col.Min_Comp_Amt}}</td>
        </tr>
      </table>
      <div class="float-right">
      <pagination-controls (pageChange)="p5 = $event" id="fifth"></pagination-controls>
    </div>
    </div>
  </tab>
  </tabset>
</div>



<div class="card" *ngIf="showMainContent">
  <div class="card-header c4">
    Compensation By

  </div>
  <tabset>
    <tab heading="WSID">
        <div class="table-wrapper" >
            <div class="btn btn-primary btn-sm float-right" (click)="xlsxReport(dataSource6, 'Compensation_by_wsid')">
                Export
              </div>
          <table class="table table-bordered">
            <tr>
              <th *ngFor="let col of displayedCol6">
                {{col}}
              </th>
            </tr>
            <tr *ngFor="let col of dataSource6 | paginate: { itemsPerPage: 7, currentPage: p6, id: 'sixth'}">
              <td>{{col.WSID}}</td>
              <td>{{col.WSID_Frequency}}</td>
              <td>{{col.Comp_Amt}}</td>
              <td>{{col.Average_Comp_Amt}}</td>
              <td>{{col.Max_Comp_Amt}}</td>
              <td>{{col.Min_Comp_Amt}}</td>
            </tr>
          </table>
          <div class="float-right">
          <pagination-controls (pageChange)="p6 = $event" id="sixth"></pagination-controls>
        </div>
        </div>
    </tab>
    <tab heading="Village">
        <div class="table-wrapper" >
            <div class="btn btn-primary btn-sm float-right" (click)="xlsxReport(dataSource7, 'Comp_by_village_by_data_range')">
                Export
              </div>
          <table class="table table-bordered">
            <tr>
              <th *ngFor="let col of displayedCol7">
                {{col}}
              </th>
            </tr>
            <tr *ngFor="let col of dataSource7 | paginate: { itemsPerPage: 7, currentPage: p7, id: 'seventh'}">
              <td>{{col.VILLAGE}}</td>
              <td>{{col.Comp_Frequency}}</td>
              <td>{{col.Comp_Amt}}</td>
              <td>{{col.Average_Comp_Amt}}</td>
              <td>{{col.Max_Comp_Amt}}</td>
              <td>{{col.Min_Comp_Amt}}</td>
            </tr>
          </table>
          <div class="float-right">
          <pagination-controls (pageChange)="p7 = $event" id="seventh"></pagination-controls>
        </div>
        </div>

    </tab>
  </tabset>


  </div>

  <div class="card" *ngIf="!showMainContent">
  <div class="card-header c4">
    Total Compensation By Category 
  </div>
  <div class="card-body">
    <div>
        <div class="btn btn-primary btn-sm float-right" (click)="xlsxReport(datcomp, 'Total_Compensation_Category')">
            Export
          </div>
      <table class="table table-bordered">
        <tr class="table-secondary">
          <th  *ngFor="let col of displayedcompCol">
            {{col}}
          </th>
        </tr>
        <tr class="table-warning"*ngFor="let col of datcomp">
          <td>{{col.HWC_Category}}</td>
          <td>{{col.Comp_Frequency}}</td>
          <td>{{col.Comp_Amt}}</td>
          <td>{{col.Average_Comp_Amt}}</td>
          <td>{{col.Max_Comp_Amt}}</td>
          <td>{{col.Min_Comp_Amt}}</td>
        </tr>
      </table>
    </div>
  </div>
</div>

<div class="col-lg-6">
 <div class="card" *ngIf="!showMainContent">
  <div class="card-header c4">
    Total No Of Sheets 
  </div>
  <div class="card-body">
    <div>
        <div class="btn btn-primary btn-sm float-right" (click)="xlsxReport(totalsheetdata, 'Total_NO_Of_Sheets_In_Compensation')">
            Export
          </div>
      <table class="table table-bordered">
        <tr class="table-secondary">
          <th  *ngFor="let col of displayedsheetCol">
            {{col}}
          </th>
        </tr>
        <tr class="table-warning"*ngFor="let col of totalsheetdata">
          <td>{{col.No_of_sheet}}</td>
        </tr>
      </table>
    </div>
  </div>
</div>
</div>



<div class="card" *ngIf="showMainContent">
  <div class="card-header c4">
    All OM_Sheet By Date
  </div>
  <div class="card-body">
    <div>
        <div class="btn btn-primary btn-sm float-right" (click)="xlsxReport(dataomsheet, 'Total_OM_Sheets_In_Compensation_BY_date')">
            Export
          </div>
      <table class="table table-bordered">
        <tr class="table-secondary">
          <th  *ngFor="let col of omsheetdisplayedCol">
            {{col}}
          </th>
        </tr>
        <tr class="table-warning" *ngFor="let col of dataomsheet | paginate: { itemsPerPage: 7, currentPage: omsheet, id: 'seventhom'}">
          <td>{{col.Om_Sheet_Date}}</td>
          <td>{{col.Comp_Amt}}</td>
          <td>{{col.Average_Comp_Amt}}</td>
          <td>{{col.Max_Comp_Amt}}</td>
          <td>{{col.Min_Comp_Amt}}</td>
        </tr>
      </table>
      <div class="float-right">
          <pagination-controls (pageChange)="omsheet = $event" id="seventhom"></pagination-controls>
        </div>
    </div>
  </div>
</div>

<div class="card" *ngIf="showMainContent">
  <div class="card-header c4">
    Total Compenastion OM_Sheet
  </div>
  <div class="card-body">
    <div>
        <div class="btn btn-primary btn-sm float-right" (click)="xlsxReport(allcompomsheetdata, 'ALL_Compensation_OM_Sheets_BY_date')">
            Export
          </div>
      <table class="table table-bordered">
        <tr class="table-secondary">
          <th  *ngFor="let col of allcompsheetcol">
            {{col}}
          </th>
        </tr>
        <tr class="table-warning" *ngFor="let col of allcompomsheetdata | paginate: { itemsPerPage: 7, currentPage: omsheetcomp, id: 'seventhomcomp'}">
          <td>{{col.OM_SHEET_NO}}</td>
          <td>{{col.WSID}}</td>
          <td>{{col.Frequency}}</td>
          <td>{{col.Comp_Amt}}</td>
          <td>{{col.Average_Comp_Amt}}</td>
          <td>{{col.Max_Comp_Amt}}</td>
          <td>{{col.Min_Comp_Amt}}</td>
        </tr>
      </table>
      <div class="float-right">
          <pagination-controls (pageChange)="omsheetcomp = $event" id="seventhomcomp"></pagination-controls>
        </div>
    </div>
  </div>
</div>

<div class="card" *ngIf="showMainContent">
  <div class="card-header c4">
    Total Compensation By OM Sheet By Date
  </div>
  <div class="card-body">
    <div>
        <div class="btn btn-primary btn-sm float-right" (click)="xlsxReport(dataomsheetcomp, 'Total_OM_Sheets_In_Compensation_BY_date')">
            Export
          </div>
      <table class="table table-bordered">
        <tr class="table-secondary">
          <th  *ngFor="let col of omsheetcompdisplayedCol">
            {{col}}
          </th>
        </tr>
        <tr class="table-warning" *ngFor="let col of dataomsheetcomp | paginate: { itemsPerPage: 7, currentPage: omsheet1, id: 'seventhom1'}">
          <td>{{col.Om_Sheet_Date}}</td>
          <td>{{col.Freq_Comp}}</td>
          <td>{{col.Comp_Amt}}</td>
          <td>{{col.Average_Comp_Amt}}</td>
          <td>{{col.Max_Comp_Amt}}</td>
          <td>{{col.Min_Comp_Amt}}</td>
        </tr>
      </table>
      <div class="float-right">
          <pagination-controls (pageChange)="omsheet1 = $event" id="seventhom1"></pagination-controls>
        </div>
    </div>
  </div>
</div>
<div class="col-lg-6">
 <div class="card" *ngIf="showMainContent">
  <div class="card-header c4">
    Total No Of Sheets 
  </div>
  <div class="card-body">
    <div>
        <div class="btn btn-primary btn-sm float-right" (click)="xlsxReport(datares, 'Total_NO_Of_Sheets_In_Compensation_BY_date_range')">
            Export
          </div>
      <table class="table table-bordered">
        <tr class="table-secondary">
          <th  *ngFor="let col of totalsheetdisplayedCol">
            {{col}}
          </th>
        </tr>
        <tr class="table-warning" *ngFor="let col of datares">
          <td>{{col.No_of_sheets}}</td>
        </tr>
      </table>
    </div>
  </div>
</div>
</div>
<!-- <div class="card">
  <div class="card-header c4">
    Compensation By
  </div>
  <div class="card-body">
    <div>
      <table class="table table-bordered">
        <tr>
          <th *ngFor="let col of displayedCol7">
            {{col}}
          </th>
        </tr>
        <tr *ngFor="let col of dataSource7">

          <td>{{col.VILLAGE}}</td>
          <td>{{col.FREQ}}</td>
          <td>{{col.AVERAGE}}</td>
          <td>{{col.COMP_MAX}}</td>
          <td>{{col.COMP_MIN}}</td>
        </tr>
      </table>
    </div>

  </div>
</div> -->



<!-- <div class="card">
  <div class="card-header">
    Compensation
    <button mat-raised-button (click)="xlsxReport()" class="btn btn-primary pull-right">Export to Excel</button>
  </div>

  <div class="mat-elevation-z8 hwc">
    <mat-table [dataSource]="dataSource">
      <ng-container matColumnDef="COM_METAINSTANCE_ID">
        <mat-header-cell *matHeaderCellDef>DC_METAINSTANCE_ID</mat-header-cell>
        <mat-cell *matCellDef="let data">{{data.COM_METAINSTANCE_ID}}</mat-cell>
      </ng-container>
      <ng-container matColumnDef="COM_DEVICE_ID">
        <mat-header-cell *matHeaderCellDef>DC_DEVICE_ID</mat-header-cell>
        <mat-cell *matCellDef="let data">{{data.COM_DEVICE_ID}}</mat-cell>
      </ng-container>

      <ng-container matColumnDef="COM_USER_NAME">
        <mat-header-cell *matHeaderCellDef>DC_USER_NAME</mat-header-cell>
        <mat-cell *matCellDef="let data">{{data.COM_USER_NAME}}</mat-cell>
      </ng-container>

      <ng-container matColumnDef="COM_OM_TOTAL_CASES">
        <mat-header-cell *matHeaderCellDef>DC_TOTAL_CASES</mat-header-cell>
        <mat-cell *matCellDef="let data">{{data.COM_OM_TOTAL_CASES}}</mat-cell>
      </ng-container>
      <mat-header-row *matHeaderRowDef="displayedCol"></mat-header-row>
      <mat-row *matRowDef="let row; columns: displayedCol"></mat-row>
    </mat-table>
    <mat-paginator [length]="totalPost" [pageSize]="postPerPage" [pageSizeOptions]="pageSizeOptions">
    </mat-paginator>
  </div>
</div> -->

<div class="card" *ngIf="showMainContent">
    <div class="card-header">
        Om Sheet by HWC Category by date
    </div>
   <tabset>
     <tab heading="CR">
      <div>
        <table class="table table-bordered">
        <tr>
          <th *ngFor="let col of cr" [hidden]="!crcol">{{ col }}</th>
        </tr>
        <div *ngIf="crcol === undefined">No Data To Display</div>
        <tr *ngFor=" let col of crcol | paginate: { itemsPerPage: 7, currentPage: cr, id: 'seventhcr'} ">
          <td>{{ col.Om_Sheet_Date }}</td>
          <td>{{ col.HWC_Category }}</td>
          <td>{{ col.Freq_HWC_Category }}</td>
          <td>{{ col.Comp_Amt }}</td>
          <td>{{ col.Average_Comp_Amt }}</td>
          <td>{{ col.Max_Comp_Amt }}</td>
          <td>{{ col.Min_Comp_Amt }}</td>
        </tr>
      </table>
      <div class="float-right">
          <pagination-controls (pageChange)="cr = $event" id="seventhcr"></pagination-controls>
        </div>
      </div>
     </tab>
     <tab heading="CRPD">
        <table class="table table-bordered">
        <tr>
          <th *ngFor="let col of cr" [hidden]="!crpdcol">{{ col }}</th>
        </tr>
        <div *ngIf="crpdcol === undefined">No Data To Display</div>
        <tr *ngFor=" let col of crpdcol | paginate: { itemsPerPage: 7, currentPage: crpd, id: 'seventhcrpd'} ">
          <td>{{ col.Om_Sheet_Date }}</td>
          <td>{{ col.HWC_Category }}</td>
          <td>{{ col.Freq_HWC_Category }}</td>
          <td>{{ col.Comp_Amt }}</td>
          <td>{{ col.Average_Comp_Amt }}</td>
          <td>{{ col.Max_Comp_Amt }}</td>
          <td>{{ col.Min_Comp_Amt }}</td>
        </tr>
      </table>
      <div class="float-right">
          <pagination-controls (pageChange)="crpd = $event" id="seventhcrpd"></pagination-controls>
        </div>
        
     </tab>
     <tab heading="PD">
        <table class="table table-bordered">
        <tr>
          <th *ngFor="let col of cr" [hidden]="!pdcol">{{ col }}</th>
        </tr>
        <div *ngIf="pdcol === undefined">No Data To Display</div>
        <tr *ngFor=" let col of pdcol | paginate: { itemsPerPage: 7, currentPage: pd, id: 'seventhpd'} ">
          <td>{{ col.Om_Sheet_Date }}</td>
          <td>{{ col.HWC_Category }}</td>
          <td>{{ col.Freq_HWC_Category }}</td>
          <td>{{ col.Comp_Amt }}</td>
          <td>{{ col.Average_Comp_Amt }}</td>
          <td>{{ col.Max_Comp_Amt }}</td>
          <td>{{ col.Min_Comp_Amt }}</td>
        </tr>
      </table>
      <div class="float-right">
          <pagination-controls (pageChange)="pd = $event" id="seventhpd"></pagination-controls>
        </div>
    
   </tab>
   <tab heading="LP">
      <table class="table table-bordered">
        <tr>
          <th *ngFor="let col of cr" [hidden]="!lpcol">{{ col }}</th>
        </tr>
        <div *ngIf="lpcol === undefined">No Data To Display</div>
        <tr *ngFor=" let col of lpcol | paginate: { itemsPerPage: 7, currentPage: lp, id: 'seventhlp'} ">
          <td>{{ col.Om_Sheet_Date }}</td>
          <td>{{ col.HWC_Category }}</td>
          <td>{{ col.Freq_HWC_Category }}</td>
          <td>{{ col.Comp_Amt }}</td>
          <td>{{ col.Average_Comp_Amt }}</td>
          <td>{{ col.Max_Comp_Amt }}</td>
          <td>{{ col.Min_Comp_Amt }}</td>
        </tr>
      </table>
      <div class="float-right">
          <pagination-controls (pageChange)="lp = $event" id="seventhlp"></pagination-controls>
        </div>
   
  </tab>
  <tab heading="HI">
   
    <table class="table table-bordered">
        <tr>
          <th *ngFor="let col of cr" [hidden]="!hicol">{{ col }}</th>
        </tr>
        <div *ngIf="hicol === undefined">No Data To Display</div>
        <tr *ngFor=" let col of hicol | paginate: { itemsPerPage: 7, currentPage: hi, id: 'seventhhi'} ">
          <td>{{ col.Om_Sheet_Date }}</td>
          <td>{{ col.HWC_Category }}</td>
          <td>{{ col.Freq_HWC_Category }}</td>
          <td>{{ col.Comp_Amt }}</td>
          <td>{{ col.Average_Comp_Amt }}</td>
          <td>{{ col.Max_Comp_Amt }}</td>
          <td>{{ col.Min_Comp_Amt }}</td>
        </tr>
      </table>
      <div class="float-right">
          <pagination-controls (pageChange)="hi = $event" id="seventhhi"></pagination-controls>
        </div>
  </tab>
  <tab heading="HD">
    <table class="table table-bordered">
        <tr>
          <th *ngFor="let col of cr" [hidden]="!hdcol">{{ col }}</th>
        </tr>
         <div *ngIf="hdcol === undefined">No Data To Display</div>
        <tr *ngFor=" let col of hdcol | paginate: { itemsPerPage: 7, currentPage: hd, id: 'seventhhd'} ">
          <td>{{ col.Om_Sheet_Date }}</td>
          <td>{{ col.HWC_Category }}</td>
          <td>{{ col.Freq_HWC_Category }}</td>
          <td>{{ col.Comp_Amt }}</td>
          <td>{{ col.Average_Comp_Amt }}</td>
          <td>{{ col.Max_Comp_Amt }}</td>
          <td>{{ col.Min_Comp_Amt }}</td>
        </tr>
      </table>
      <div class="float-right">
          <pagination-controls (pageChange)="hd = $event" id="seventhhd"></pagination-controls>
        </div>
  </tab>
   </tabset>
   </div>
